<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pong Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: #000;
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }

        .game-header {
            text-align: center;
            margin-bottom: 20px;
        }

        h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 0 0 20px #fff;
            letter-spacing: 5px;
        }

        .score-display {
            font-size: 2rem;
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            gap: 50px;
        }

        .player-score {
            text-align: center;
        }

        .player-name {
            font-size: 1rem;
            opacity: 0.7;
            margin-bottom: 5px;
        }

        .score {
            font-size: 3rem;
            font-weight: bold;
            text-shadow: 0 0 10px #fff;
        }

        .game-container {
            position: relative;
            margin-bottom: 20px;
        }

        #gameCanvas {
            border: 2px solid #fff;
            background: #000;
            box-shadow: 0 0 30px rgba(255,255,255,0.3);
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        button {
            padding: 12px 24px;
            font-size: 1rem;
            font-weight: bold;
            border: 2px solid #fff;
            background: transparent;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Courier New', monospace;
            text-transform: uppercase;
        }

        button:hover {
            background: #fff;
            color: #000;
            box-shadow: 0 0 20px rgba(255,255,255,0.5);
        }

        button:active {
            transform: scale(0.95);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .mobile-controls {
            display: none;
            flex-direction: column;
            gap: 10px;
            position: absolute;
            right: -80px;
            top: 50%;
            transform: translateY(-50%);
        }

        .mobile-controls button {
            width: 60px;
            height: 60px;
            font-size: 1.5rem;
            padding: 0;
        }

        .menu-screen, .game-over-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .screen-content {
            text-align: center;
            border: 3px solid #fff;
            padding: 40px;
            background: #000;
            box-shadow: 0 0 50px rgba(255,255,255,0.3);
            max-width: 500px;
            margin: 20px;
        }

        .screen-content h2 {
            font-size: 2.5rem;
            margin-bottom: 30px;
            text-shadow: 0 0 20px #fff;
        }

        .menu-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 30px 0;
        }

        .difficulty-selector {
            margin: 20px 0;
        }

        .difficulty-selector h3 {
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .difficulty-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .difficulty-btn {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .difficulty-btn.active {
            background: #fff;
            color: #000;
        }

        .game-over-screen {
            display: none;
        }

        .winner-text {
            font-size: 1.5rem;
            margin: 20px 0;
            text-shadow: 0 0 15px #fff;
        }

        .instructions {
            max-width: 800px;
            margin-top: 20px;
            padding: 20px;
            border: 1px solid #fff;
            background: rgba(255,255,255,0.05);
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .instructions h3 {
            margin-bottom: 10px;
            font-size: 1.1rem;
            text-shadow: 0 0 10px #fff;
        }

        .instructions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .pause-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            text-shadow: 0 0 20px #fff;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
                letter-spacing: 2px;
            }
            
            .score-display {
                font-size: 1.5rem;
                gap: 30px;
            }
            
            .score {
                font-size: 2rem;
            }
            
            #gameCanvas {
                width: 100%;
                max-width: 400px;
                height: auto;
            }
            
            .mobile-controls {
                display: flex;
                position: static;
                flex-direction: row;
                transform: none;
                margin-top: 15px;
            }
            
            .instructions-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .screen-content {
                padding: 20px;
                margin: 10px;
            }
            
            .difficulty-buttons {
                flex-direction: column;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
        }

        .trail {
            position: absolute;
            width: 10px;
            height: 10px;
            background: rgba(255,255,255,0.3);
            border-radius: 50%;
            pointer-events: none;
            animation: fadeOut 0.5s ease-out forwards;
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
                transform: scale(0);
            }
        }
    </style>
</head>
<body>
    <div class="game-header">
        <h1>PONG</h1>
        
        <div class="score-display">
            <div class="player-score">
                <div class="player-name" id="player1Name">JUGADOR</div>
                <div class="score" id="player1Score">0</div>
            </div>
            <div class="player-score">
                <div class="player-name" id="player2Name">CPU</div>
                <div class="score" id="player2Score">0</div>
            </div>
        </div>
    </div>

    <div class="game-container">
        <canvas id="gameCanvas" width="800" height="400"></canvas>
        
        <div class="pause-overlay" id="pauseOverlay">
            PAUSA
        </div>
        
        <div class="mobile-controls">
            <button id="upBtn">‚Üë</button>
            <button id="downBtn">‚Üì</button>
        </div>
    </div>

    <div class="controls">
        <button onclick="showMenu()" id="menuBtn">MEN√ö</button>
        <button onclick="togglePause()" id="pauseBtn" disabled>PAUSA</button>
        <button onclick="resetGame()" id="resetBtn">REINICIAR</button>
    </div>

    <div class="menu-screen" id="menuScreen">
        <div class="screen-content">
            <h2>PONG</h2>
            
            <div class="menu-options">
                <button onclick="startGame('cpu')">JUGADOR vs CPU</button>
                <button onclick="startGame('player')">JUGADOR vs JUGADOR</button>
                <button onclick="startGame('practice')">MODO PR√ÅCTICA</button>
            </div>
            
            <div class="difficulty-selector" id="difficultySelector">
                <h3>DIFICULTAD CPU:</h3>
                <div class="difficulty-buttons">
                    <button class="difficulty-btn active" data-difficulty="easy">F√ÅCIL</button>
                    <button class="difficulty-btn" data-difficulty="medium">MEDIO</button>
                    <button class="difficulty-btn" data-difficulty="hard">DIF√çCIL</button>
                    <button class="difficulty-btn" data-difficulty="impossible">IMPOSIBLE</button>
                </div>
            </div>
            
            <div class="difficulty-selector">
                <h3>PUNTOS PARA GANAR:</h3>
                <div class="difficulty-buttons">
                    <button class="difficulty-btn" data-target="5">5</button>
                    <button class="difficulty-btn active" data-target="10">10</button>
                    <button class="difficulty-btn" data-target="15">15</button>
                </div>
            </div>
        </div>
    </div>

    <div class="game-over-screen" id="gameOverScreen">
        <div class="screen-content">
            <h2>JUEGO TERMINADO</h2>
            <div class="winner-text" id="winnerText">¬°JUGADOR 1 GANA!</div>
            <div class="menu-options">
                <button onclick="playAgain()">JUGAR DE NUEVO</button>
                <button onclick="showMenu()">MEN√ö PRINCIPAL</button>
            </div>
        </div>
    </div>

    <div class="instructions">
        <div class="instructions-grid">
            <div>
                <h3>‚å®Ô∏è CONTROLES DESKTOP</h3>
                <p><strong>Jugador 1:</strong> W/S o ‚Üë/‚Üì<br>
                <strong>Jugador 2:</strong> I/K o Mouse<br>
                <strong>Espacio:</strong> Pausar<br>
                <strong>Enter:</strong> Reiniciar</p>
            </div>
            <div>
                <h3>üì± CONTROLES MOBILE</h3>
                <p><strong>Botones:</strong> ‚Üë/‚Üì para mover<br>
                <strong>Gestos:</strong> Deslizar verticalmente<br>
                <strong>Interfaz:</strong> Botones de control</p>
            </div>
            <div>
                <h3>üéØ OBJETIVO</h3>
                <p>Golpea la pelota con tu paleta para que pase la paleta del oponente. Primer jugador en llegar a la puntuaci√≥n objetivo gana.</p>
            </div>
            <div>
                <h3>üéÆ MODOS</h3>
                <p><strong>vs CPU:</strong> 4 dificultades<br>
                <strong>vs Jugador:</strong> Multijugador local<br>
                <strong>Pr√°ctica:</strong> Sin oponente</p>
            </div>
        </div>
    </div>

    <script>
        // Game constants
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        const PADDLE_WIDTH = 10;
        const PADDLE_HEIGHT = 80;
        const BALL_SIZE = 10;
        const PADDLE_SPEED = 6;
        const BALL_SPEED = 4;
        const MAX_BALL_SPEED = 8;

        // Game variables
        let gameState = 'menu'; // menu, playing, paused, gameOver
        let gameMode = 'cpu'; // cpu, player, practice
        let difficulty = 'medium';
        let targetScore = 10;
        let animationId = null;

        // Game objects
        const player1 = {
            x: 20,
            y: canvas.height / 2 - PADDLE_HEIGHT / 2,
            width: PADDLE_WIDTH,
            height: PADDLE_HEIGHT,
            score: 0,
            upPressed: false,
            downPressed: false
        };

        const player2 = {
            x: canvas.width - 30,
            y: canvas.height / 2 - PADDLE_HEIGHT / 2,
            width: PADDLE_WIDTH,
            height: PADDLE_HEIGHT,
            score: 0,
            upPressed: false,
            downPressed: false
        };

        const ball = {
            x: canvas.width / 2,
            y: canvas.height / 2,
            dx: BALL_SPEED,
            dy: BALL_SPEED,
            size: BALL_SIZE,
            speed: BALL_SPEED
        };

        // CPU AI settings
        const cpuSettings = {
            easy: { speed: 3, errorRate: 0.3, reactionDelay: 10 },
            medium: { speed: 4, errorRate: 0.15, reactionDelay: 5 },
            hard: { speed: 5, errorRate: 0.05, reactionDelay: 2 },
            impossible: { speed: 6, errorRate: 0, reactionDelay: 0 }
        };

        let cpuReactionCounter = 0;

        // Initialize
        setupEventListeners();
        setupDifficultyButtons();
        gameLoop();

        function setupEventListeners() {
            // Keyboard controls
            document.addEventListener('keydown', handleKeyDown);
            document.addEventListener('keyup', handleKeyUp);
            
            // Mobile controls
            document.getElementById('upBtn').addEventListener('touchstart', () => player1.upPressed = true);
            document.getElementById('upBtn').addEventListener('touchend', () => player1.upPressed = false);
            document.getElementById('downBtn').addEventListener('touchstart', () => player1.downPressed = true);
            document.getElementById('downBtn').addEventListener('touchend', () => player1.downPressed = false);
            
            // Mouse control for player 2 (in 2-player mode)
            canvas.addEventListener('mousemove', handleMouseMove);
            
            // Touch controls for mobile
            canvas.addEventListener('touchstart', handleTouchStart);
            canvas.addEventListener('touchmove', handleTouchMove);
        }

        function setupDifficultyButtons() {
            // Difficulty buttons
            document.querySelectorAll('[data-difficulty]').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('[data-difficulty]').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    difficulty = this.dataset.difficulty;
                });
            });
            
            // Target score buttons
            document.querySelectorAll('[data-target]').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('[data-target]').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    targetScore = parseInt(this.dataset.target);
                });
            });
        }

        function handleKeyDown(event) {
            switch(event.code) {
                case 'KeyW':
                case 'ArrowUp':
                    event.preventDefault();
                    player1.upPressed = true;
                    break;
                case 'KeyS':
                case 'ArrowDown':
                    event.preventDefault();
                    player1.downPressed = true;
                    break;
                case 'KeyI':
                    if (gameMode === 'player') {
                        player2.upPressed = true;
                    }
                    break;
                case 'KeyK':
                    if (gameMode === 'player') {
                        player2.downPressed = true;
                    }
                    break;
                case 'Space':
                    event.preventDefault();
                    togglePause();
                    break;
                case 'Enter':
                    event.preventDefault();
                    if (gameState === 'gameOver') {
                        playAgain();
                    } else {
                        resetGame();
                    }
                    break;
                case 'Escape':
                    showMenu();
                    break;
            }
        }

        function handleKeyUp(event) {
            switch(event.code) {
                case 'KeyW':
                case 'ArrowUp':
                    player1.upPressed = false;
                    break;
                case 'KeyS':
                case 'ArrowDown':
                    player1.downPressed = false;
                    break;
                case 'KeyI':
                    player2.upPressed = false;
                    break;
                case 'KeyK':
                    player2.downPressed = false;
                    break;
            }
        }

        function handleMouseMove(event) {
            if (gameMode === 'player' && gameState === 'playing') {
                const rect = canvas.getBoundingClientRect();
                const mouseY = event.clientY - rect.top;
                player2.y = mouseY - PADDLE_HEIGHT / 2;
                
                // Keep paddle within bounds
                player2.y = Math.max(0, Math.min(canvas.height - PADDLE_HEIGHT, player2.y));
            }
        }

        function handleTouchStart(event) {
            event.preventDefault();
            if (gameState === 'playing') {
                const rect = canvas.getBoundingClientRect();
                const touch = event.touches[0];
                const touchY = touch.clientY - rect.top;
                
                if (touchY < canvas.height / 2) {
                    player1.upPressed = true;
                } else {
                    player1.downPressed = true;
                }
            }
        }

        function handleTouchMove(event) {
            event.preventDefault();
            if (gameState === 'playing') {
                const rect = canvas.getBoundingClientRect();
                const touch = event.touches[0];
                const touchY = touch.clientY - rect.top;
                player1.y = touchY - PADDLE_HEIGHT / 2;
                
                // Keep paddle within bounds
                player1.y = Math.max(0, Math.min(canvas.height - PADDLE_HEIGHT, player1.y));
            }
        }

        function startGame(mode) {
            gameMode = mode;
            gameState = 'playing';
            
            // Reset scores and positions
            player1.score = 0;
            player2.score = 0;
            resetBall();
            resetPaddles();
            
            // Update UI
            document.getElementById('menuScreen').style.display = 'none';
            document.getElementById('gameOverScreen').style.display = 'none';
            document.getElementById('pauseBtn').disabled = false;
            
            // Update player names
            document.getElementById('player1Name').textContent = 'JUGADOR 1';
            if (mode === 'cpu') {
                document.getElementById('player2Name').textContent = 'CPU';
            } else if (mode === 'player') {
                document.getElementById('player2Name').textContent = 'JUGADOR 2';
            } else {
                document.getElementById('player2Name').textContent = 'PR√ÅCTICA';
            }
            
            updateScore();
            trackEvent('game_start', { mode: gameMode, difficulty: difficulty });
        }

        function showMenu() {
            gameState = 'menu';
            document.getElementById('menuScreen').style.display = 'flex';
            document.getElementById('pauseBtn').disabled = true;
            
            // Show/hide difficulty selector based on mode
            const difficultySelector = document.getElementById('difficultySelector');
            difficultySelector.style.display = gameMode === 'cpu' ? 'block' : 'none';
        }

        function togglePause() {
            if (gameState === 'playing') {
                gameState = 'paused';
                document.getElementById('pauseOverlay').style.display = 'flex';
                document.getElementById('pauseBtn').textContent = 'REANUDAR';
            } else if (gameState === 'paused') {
                gameState = 'playing';
                document.getElementById('pauseOverlay').style.display = 'none';
                document.getElementById('pauseBtn').textContent = 'PAUSA';
            }
        }

        function resetGame() {
            if (gameState !== 'menu') {
                player1.score = 0;
                player2.score = 0;
                resetBall();
                resetPaddles();
                updateScore();
                
                if (gameState === 'paused') {
                    togglePause();
                }
            }
        }

        function resetBall() {
            ball.x = canvas.width / 2;
            ball.y = canvas.height / 2;
            ball.speed = BALL_SPEED;
            
            // Random direction
            ball.dx = (Math.random() > 0.5 ? 1 : -1) * ball.speed;
            ball.dy = (Math.random() - 0.5) * ball.speed;
        }

        function resetPaddles() {
            player1.y = canvas.height / 2 - PADDLE_HEIGHT / 2;
            player2.y = canvas.height / 2 - PADDLE_HEIGHT / 2;
        }

        function gameLoop() {
            if (gameState === 'playing') {
                update();
            }
            draw();
            animationId = requestAnimationFrame(gameLoop);
        }

        function update() {
            // Update player 1
            if (player1.upPressed && player1.y > 0) {
                player1.y -= PADDLE_SPEED;
            }
            if (player1.downPressed && player1.y < canvas.height - PADDLE_HEIGHT) {
                player1.y += PADDLE_SPEED;
            }

            // Update player 2 or CPU
            if (gameMode === 'player') {
                if (player2.upPressed && player2.y > 0) {
                    player2.y -= PADDLE_SPEED;
                }
                if (player2.downPressed && player2.y < canvas.height - PADDLE_HEIGHT) {
                    player2.y += PADDLE_SPEED;
                }
            } else if (gameMode === 'cpu') {
                updateCPU();
            }

            // Update ball
            updateBall();

            // Check for scoring
            if (ball.x < 0) {
                player2.score++;
                updateScore();
                checkGameOver();
                if (gameState === 'playing') {
                    setTimeout(resetBall, 1000);
                }
                trackEvent('point_scored', { scorer: 'player2', score: `${player1.score}-${player2.score}` });
            } else if (ball.x > canvas.width) {
                player1.score++;
                updateScore();
                checkGameOver();
                if (gameState === 'playing') {
                    setTimeout(resetBall, 1000);
                }
                trackEvent('point_scored', { scorer: 'player1', score: `${player1.score}-${player2.score}` });
            }
        }

        function updateCPU() {
            const settings = cpuSettings[difficulty];
            cpuReactionCounter++;
            
            if (cpuReactionCounter >= settings.reactionDelay) {
                // Add some error to make CPU more human-like
                if (Math.random() > settings.errorRate) {
                    const paddleCenter = player2.y + PADDLE_HEIGHT / 2;
                    const ballY = ball.y;
                    const diff = ballY - paddleCenter;
                    
                    if (Math.abs(diff) > 5) {
                        if (diff > 0 && player2.y < canvas.height - PADDLE_HEIGHT) {
                            player2.y += Math.min(settings.speed, diff);
                        } else if (diff < 0 && player2.y > 0) {
                            player2.y += Math.max(-settings.speed, diff);
                        }
                    }
                }
                cpuReactionCounter = 0;
            }
        }

        function updateBall() {
            if (gameMode === 'practice' && (ball.x < 0 || ball.x > canvas.width)) {
                // In practice mode, bounce off sides
                ball.dx = -ball.dx;
                ball.x = Math.max(ball.size, Math.min(canvas.width - ball.size, ball.x));
            } else {
                ball.x += ball.dx;
                ball.y += ball.dy;
            }

            // Bounce off top and bottom walls
            if (ball.y <= ball.size || ball.y >= canvas.height - ball.size) {
                ball.dy = -ball.dy;
                ball.y = Math.max(ball.size, Math.min(canvas.height - ball.size, ball.y));
            }

            // Check paddle collisions
            checkPaddleCollision(player1);
            checkPaddleCollision(player2);
        }

        function checkPaddleCollision(paddle) {
            if (ball.x - ball.size < paddle.x + paddle.width &&
                ball.x + ball.size > paddle.x &&
                ball.y - ball.size < paddle.y + paddle.height &&
                ball.y + ball.size > paddle.y) {
                
                // Calculate bounce angle based on where ball hits paddle
                const relativeIntersectY = (paddle.y + paddle.height / 2) - ball.y;
                const normalizedIntersect = relativeIntersectY / (paddle.height / 2);
                const bounceAngle = normalizedIntersect * Math.PI / 4; // Max 45 degrees
                
                // Determine direction
                const direction = ball.x < canvas.width / 2 ? 1 : -1;
                
                // Apply new velocity
                ball.dx = direction * Math.cos(bounceAngle) * ball.speed;
                ball.dy = Math.sin(bounceAngle) * ball.speed;
                
                // Increase speed slightly
                ball.speed = Math.min(MAX_BALL_SPEED, ball.speed + 0.1);
                
                // Move ball away from paddle to prevent sticking
                if (direction > 0) {
                    ball.x = paddle.x + paddle.width + ball.size;
                } else {
                    ball.x = paddle.x - ball.size;
                }
            }
        }

        function draw() {
            // Clear canvas
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw center line
            ctx.setLineDash([5, 15]);
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(canvas.width / 2, 0);
            ctx.lineTo(canvas.width / 2, canvas.height);
            ctx.stroke();
            ctx.setLineDash([]);

            // Draw paddles
            ctx.fillStyle = '#fff';
            ctx.fillRect(player1.x, player1.y, player1.width, player1.height);
            ctx.fillRect(player2.x, player2.y, player2.width, player2.height);

            // Draw ball
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ball.size, 0, Math.PI * 2);
            ctx.fill();

            // Draw ball trail effect
            if (gameState === 'playing') {
                createBallTrail();
            }
        }

        function createBallTrail() {
            // Simple trail effect - could be enhanced
            ctx.globalAlpha = 0.3;
            ctx.beginPath();
            ctx.arc(ball.x - ball.dx, ball.y - ball.dy, ball.size * 0.7, 0, Math.PI * 2);
            ctx.fill();
            ctx.globalAlpha = 1;
        }

        function updateScore() {
            document.getElementById('player1Score').textContent = player1.score;
            document.getElementById('player2Score').textContent = player2.score;
        }

        function checkGameOver() {
            if (player1.score >= targetScore || player2.score >= targetScore) {
                gameState = 'gameOver';
                
                let winner;
                if (player1.score >= targetScore) {
                    winner = gameMode === 'cpu' ? 'JUGADOR GANA' : 'JUGADOR 1 GANA';
                } else {
                    winner = gameMode === 'cpu' ? 'CPU GANA' : 'JUGADOR 2 GANA';
                }
                
                document.getElementById('winnerText').textContent = winner;
                document.getElementById('gameOverScreen').style.display = 'flex';
                document.getElementById('pauseBtn').disabled = true;
                
                trackEvent('game_over', {
                    winner: player1.score >= targetScore ? 'player1' : 'player2',
                    finalScore: `${player1.score}-${player2.score}`,
                    mode: gameMode,
                    difficulty: difficulty
                });
            }
        }

        function playAgain() {
            document.getElementById('gameOverScreen').style.display = 'none';
            startGame(gameMode);
        }

        function trackEvent(eventType, data = {}) {
            const event = {
                game: 'pong',
                type: eventType,
                timestamp: new Date().toISOString(),
                data: data
            };
            
            fetch('/analytics/event', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(event)
            }).catch(err => {
                const events = JSON.parse(localStorage.getItem('pongEvents') || '[]');
                events.push(event);
                localStorage.setItem('pongEvents', JSON.stringify(events));
            });
        }
    </script>
</body>
</html>